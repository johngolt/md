RFM模型最早是用来衡量客户价值和客户创利能力。理解RFM框架的思想是构造统计类特征的基础，其含义为：

- **R（Recency）**：客户最近一次交易消费时间的间隔。R值越大，表示客户交易发生的日期越久，反之则表示客户交易发生的日期越近。
- **F（Frequency）**：客户在最近一段时间内交易消费的次数。F值越大，表示客户交易越频繁，反之则表示客户交易不够活跃。
- **M（Monetary）**：客户在最近一段时间内交易消费的金额。M值越大，表示客户价值越高，反之则表示客户价值越低。

###### 数量统计类特征

对于不同数据源，我们可以统计得到不同内容的RFM特征。例如：

- 运营商数据：用户每天的通话记录次数、时长等。
- 信用卡账单或电商交易数据：用户每天的交易笔数、金额等。
- 埋点行为数据：用户每天在某页面的浏览量、点击量等。
- 设备数据：用户每天的登陆、活跃次数。

接下来，我们就可以继续细分类目来统计。例如：

- 信用卡交易数据：用户每天在母婴用品、交通出行、餐饮、美容美发等交易笔数、金额。
- 设备App数据：用户手机上安装的借贷类、生活类、运动类、音乐类等App的数量。

###### 占比统计类特征

在得到数量统计类特征后，我们继续衍生占比类特征，一方面可用来去除量纲影响，另一方面衡量用户的行为偏好。例如：

> 最近N个月内**母婴类**消费次数**占比** = 最近N个月内**母婴类**消费**次数** / 最近N个月内消费次数

###### 趋势统计类特征

由于一个人的行为是会动态变化的，衡量这种变化趋势对于风险识别也很重要，我们一般计算斜率来衡量这种变化趋势。例如：

> 多头借贷趋势 =（当月的多头借贷次数 - 上个月的多头借贷次数）/ 上个月的多头借贷次数

###### 稳定性衍生特征

在不同时间点统计的数量特征基础上，我们可以继续衡量用户行为的稳定性。可以用变异系数来衡量这种数据波动水平。变异系数越小，代表波动越小，稳定性越好。

> 变异系数的计算公式为：变异系数 =（ 标准偏差 SD / 平均值Mean ）× 100%

###### 第三方多头借贷变量

第三方多头借贷数据通常包含以下变量：

> 借款人最近7天、1个月、3个月、6个月、12个月、18个月、24个月的某类平台借贷次数
>
> 某类平台包含：消费金融公司、互联网金融公司、银行信贷、数据风控公司等等。

根据这些原始变量，我们可以按照以上方法论衍生一些新变量。例如：如果以“最近7天的多头借贷次数 / 最近1个月的多头借贷次数”，我们便可以判断借款人的时间维度上的借贷行为分布。这个变量数值越大，代表近期借贷集中，短期风险更大。如果以“最近1个月的银行信贷借贷次数 / 最近1个月的多头借贷次数”，我们便可以判断借款人的在借贷平台维度的分布。这个变量数值越大，可以认为越趋于正面。

#### 时间特征

##### 连续时间

- 持续时间：浏览时长；
- 间隔时间：购买/点击距今时长；距离假期的前后时长（节假日前和节假日后可能会出现明显的数据波动）；

##### 离散时间

- 年、季度、季节、月、星期、日、时 等；

- - 基本特征，如果用 Xgboost 模型可以进行 one-hot 编码；
  - 如果类别比较多，可以尝试平均数编码（Mean Encoding）。
  - 或者取 cos/sin 将数值的首位衔接起来，比如说 23 点与 0 点很近，星期一和星期天很近。

- 节假日、节假日第 n 天、节假日前 n 天、节假日后 n 天；

- - 数据可能会随着节假日的持续而发生变化，比如说递减；
  - 节假日前/后可能会出现数据波动；
  - 不放假的人造节日如 5.20、6.18、11.11 等也需要考虑一下；

- 一天的某个时间段；

- - 上午、中午、下午、傍晚、晚上、深夜、凌晨等；

- 年初、年末、月初、月末、周内、周末；

- - 基本特征；

- 高峰时段、是否上班、是否营业、是否双休日；

- - 主要根据业务场景进行挖掘。

#### 聚合特征

##### 统计值

基于历史数据构造长中短期的统计值，包括前 n 天/周期内的：

- 四分位数；

- 中位数、平均数、偏差；

- 偏度、峰度；

- - 挖掘数据的偏离程度和集中程度；

- 离散系数；

- - 挖掘离散程度

这里可以用自相关系数（autocorrelation）挖掘出周期性。

##### 同期值

前 n 个周期/天/月/年的同期值；

##### 交叉特征

- 类别特征间组合构成新特征：

- - 笛卡尔积，比如星期和小时：Mon_10（星期一的十点）；

- 类别特征和连续特征：

- - 连续特征分桶后进行笛卡尔积；
  - 基于类别特征进行 groupby 操作，类似聚合特征的构造；

- 连续特征和连续特征：

- - 同比和环比（一阶差分）：反应同期或上一个统计时段的变换大小；
  - 二阶差分：反应变化趋势；
  - 比值；