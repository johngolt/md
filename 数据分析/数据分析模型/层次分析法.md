##### 层次分析法

`AHP`是一种使用定性与定量相结合的方法来解决多因素复杂问题的决策分析方法。该方法需要决策者的经验来判断各衡量因素之间的相对重要程度，并合理地给出每个因素标准的权数，利用权数求出各方案的优劣次序，能比较有效地应用于那些难以用定量方法解决的问题。

###### 建立评分体系

构建用户价值评分体系，对各类用户进行精细化运营。列出影响目标的所有元素。采用专家打分、用户问卷等方式，逐一列出所有的影响因素，比如活跃度、忠诚度、购买力等。

###### 构建层次结构、判断矩阵

列出影响因素的指标或方案。判断影响用户活跃度的指标有浏览页面次数、停留时长、浏览商品次数、下单次数。判断影响用户忠诚度的指标有最近访问时间、访问频率、主动评价次数。判断影响用户购买力的指标有单笔最高金额、平均订单金额、购买次数。

| 量化值  | 因素i比因素j                                                 |
| ------- | ------------------------------------------------------------ |
| 1       | 同等重要                                                     |
| 3       | 稍微重要                                                     |
| 5       | 较强重要                                                     |
| 7       | 强烈重要                                                     |
| 9       | 极端重要                                                     |
| 2,4,6,8 | 相邻判断的中间值                                             |
| 倒数    | 因素i与j相比的判断为$a_{ij}$，则因素j与i相比的判断为$a_{ji}=\frac{1}{a_{ij}}$ |

运用专家打分将所有因素两两比较确定合适的标度。建立层次结构后，比较因子及下属指标的各个比重，实现定性向定量转化。比如，采用 1-9 分标度法，构建决策层的打分矩阵 A

| 专家评分 | 活跃度 | 忠诚度 | 购买力 |
| -------- | ------ | ------ | ------ |
| 活跃度   | 1      | 3      | 7      |
| 忠诚度   | 1/3    | 1      | 5      |
| 购买力   | 1/7    | 1/5    | 1      |

###### 一致性校验

一致性检验是为了检验各元素重要程度之间的协调性，避免出现 A 比 B 重要，B 比 C 重要，而 C 又比 A 重要，这样的矛盾情况。

一致性矩阵：若n阶正互反矩阵$(a_{ij})_{n\times n}$满足$a_{ik}\cdot a_{kj}=a_{ij}$，则称$(a_{ij})_{n\times n}$为一致性矩阵。n阶正互反矩阵$A$为一致性矩阵的充要条件是，$A$的最大特征值是$\lambda_{max}=n$

判断矩阵$A$的阶数n有关的平均随机一致性指标RI和一致性比例$\text{CR}=\frac{\text{CI}}{\text{RI}}$，当且仅当判断矩阵A的最大特征值$\lambda_{max}=n$，则判断矩阵A是完全一致性矩阵，如果$\text{CR}<0.1$，则判断矩阵A具有满意的一致性。否则需要调整打分值，甚至需要找出原因重建模型

| n阶  | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| RI值 | 0    | 0    | 0.52 | 0.89 | 1.12 | 1.26 | 1.36 | 1.41 | 1.46 |

先求解特征向量，采用手工计算方法——和积法：

1. 将矩阵A按列规范化$\omega_{ij}=\frac{a_{ij}}{\sum_{k=1}^na_{kj}}$

2. 将$\omega_{ij}$按行相加$\tilde{\omega_i}=\sum_{k=1}^n\omega_{ik}$

3. 将$\tilde{\omega_i}$按列规范化，得到规范化的特征向量$\omega$

4. 计算最大特征值$\lambda_{max}=\frac{1}{n}\sum_{i=1}^{n}\frac{\sum_{j=1}^na_{ij}w_j}{w_i}$

![](../../picture/2/356.png)

![](../../picture/2/357.png)

###### 算出权重系数

分别算出各个指标层、准则层的指标权重，然后再算出决策公式

![](../../picture/2/355.png)

![](../../picture/2/358.png)

###### ![](../../picture/2/359.png)

###### ![](../../picture/2/360.png)

![](../../picture/2/361.png)

###### ![](../../picture/2/362.png)

###### 层次排序

层次排序分为层次单排序和层次总排序。所谓层次单排序，指对于上一层某因素而言，本层次各因素的重要性的排序；所谓层次总排序，指确定某层所有因素总目标相对重要性的排序权值过程。层次排序是从最高层到最底层依次进行的。对于最高层次而言，其层次单排序的结果也是总排序的结果。

###### 结论

运用 AHP 模型得出和公式：

- 活跃度=b1$\times$浏览页面次数+b2$\times$停留时长+b3$\times$浏览商品次数+b4$\times$下单次数；

- 忠诚度=c1$\times$最近访问时间+c2$\times$访问频率+c3$\times$主动评价次数；

- 购买力=d1$\times$单笔最高金额+d2$\times$平均订单金额+d3$\times$购买次数；

- 用户价值评分=0.64339$\times$活跃度+0.28284$\times$忠诚度+0.07377$\times$购买力。

层次分析法计算相对简便，结果明确，基本原理比较容易掌握，所以便于决策者直接使用。但是由于此法中的比较、判断以及结果的计算过程都是粗糙的，所以不适用于精度较高的问题；同时给出判断矩阵的过程中，人主观因素对结果的影响很大，这就使得结果带有很强的主观性，会影响泛化性。